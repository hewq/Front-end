<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
</head>
<body>
	<div style="margin: 20px auto; width: 1700px;">
		<canvas id="canvasa" width="800" height="560" style="display: block; float: left; border: 1px solid #aaa;">
			Your browser does not support the HTML 5 Canvas.
		</canvas>
	</div>
	<div style="clear: both;"></div>
	<div style="text-align: center; margin-top: 50px; font-size: 20px;">
		<a href="javascript:changeColor({r:0,g:0,b:44})">Change Color</a>
	</div>

	<script>
		//注意：跨域资源访问的问题,使用webstorm或使用火狐浏览器或者通过服务器访问
		var canvasa = document.getElementById('canvasa');
		var contexta = canvasa.getContext('2d');
		var image = new Image();
		window.onload = function () {
			image.src = './images/test.png';
			image.crossOrigin = "Anonymous";
			image.onload = function () {
				contexta.drawImage(image, 0, 0, canvasa.width, canvasa.height);
			}
		}
		function changeColor(rgb) {
			var imageData = contexta.getImageData(0, 0, canvasa.width, canvasa.height);
			var pixelData = imageData.data;
			for (var i = 0; i < canvasa.width * canvasa.height; i++) {
				pixelData[i * 4 + 0] = rgb.r;
				pixelData[i * 4 + 1] = rgb.g;
				pixelData[i * 4 + 2] = rgb.b;
			}
			contexta.clearRect(0, 0, canvasa.width, canvasa.height);
			contexta.putImageData(imageData, 0, 0, 0, 0, canvasa.width, canvasa.height);
		}
	</script>
</body>
</html>