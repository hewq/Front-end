<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ajax</title>
</head>
<body>
<div id="content"></div>
<div class="data"></div>
<button id="databtn" onclick="getData()">获取内容</button>
<button id="htmlbtn" onclick="getHtml()">获取Html</button>
<button id="xmlbtn" onclick="getXml()">获取xml</button>
<button id="jqbtn">jq</button>
<button id="jsonbtn">jsonbtn</button>

<script src="jquery-3.1.0.js"></script>
<script type="text/javascript">

    function getContent(){
        var xhr;
        if(window.XMLHttpRequest){
            xhr = new XMLHttpRequest();
        }else{
            /*ie5/ie6*/
            xhr = new ActiveXObject("Microsoft.XMLHTTP");
        }

        //实时检测请求状态
        xhr.onreadystatechange = function(){
            if(xhr.readyState == 4 && xhr.status == 200){//4代表请求完成，且相应就绪
                /*
                两种获取方式
                xhr.responseText
                xhr.responseXML
                 */
                document.getElementById("content").innerHTML = xhr.responseText;
               // $("#content").innerHTML = xhr.responseText;
            }
        }

        //请求设置
        //open(请求的方法，路径，是否异步)
        xhr.open("GET","ajaxtxt.txt",true);//true为异步，不会等待所有表单填写完，默认值为true

        xhr.send();
    }

    var xhrhttp;
    function setXhr(method,url,fun){
        if(window.XMLHttpRequest){
            xhrhttp = new XMLHttpRequest();
        }else{
            /*ie5/ie6*/
            xhrhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xhrhttp.onreadystatechange = fun;
        xhrhttp.open(method,url,true);
        xhrhttp.send();
    }

    function getData(){
        setXhr("GET","ajaxtxt.txt",function(){
            if(xhrhttp.readyState == 4 && xhrhttp.status == 200){//4代表请求完成，且相应就绪
                document.getElementById("content").innerHTML = xhrhttp.responseText;
            }
        });
    }

    function getHtml(){
        setXhr("GET","ajax.html",function(){
            if(xhrhttp.readyState == 4 && xhrhttp.status == 200){//4代表请求完成，且相应就绪
                document.getElementById("content").innerHTML = xhrhttp.responseText;
            }
        });
    }

    function getXml(){
        setXhr("GET","student.xml",function(){
            if(xhrhttp.readyState == 4 && xhrhttp.status == 200){//4代表请求完成，且相应就绪
                var xmldata = xhrhttp.responseXML;
                var xmlarr = xmldata.getElementsByTagName("name");
                var str = "";
                for(var i=0;i<xmlarr.length;i++){
                    str += xmlarr[i].childNodes[0].nodeValue+"<br/>";
                }
                document.getElementById("content").innerHTML = str;
            }
        });
    }

    $("#jqbtn").bind("click",function(){
        $.ajax({
            type:"GET",
            url:"ajax.html",
            datatype:"html",
            success:function(data){
                $("body").append(data);
                $("body").find("table td").each(function(){
                    $(this).html(Math.ceil(Math.random()*100));
                });
            },
            error: function () {
                console.log("err");
            }
        });
    });

    $("#jsonbtn").bind("click",function(){
        $.ajax({
            type:"GET",
            url:"info.json",
            datatype:"json",
            beforeSend:function(){
                $(".data").html("正在加载数据。。。。");
            },
            success:function(data){
                $("body").append(data);
                $("body").find("table td").each(function(){
                    $(this).html(Math.ceil(Math.random()*100));
                });
            },
            error: function () {
                console.log("err");
            }
        });
    });
</script>
</body>
</html>