<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>
	<title>绘制图片</title>
	<script src="javascript/easeljs.min.js"></script>
	<script src="javascript/jquery.min.js"></script>
	<style>
		html, body {
			margin: 0;
			padding: 0;
			width: 100%;
			height: 100%;
			overflow: hidden;
		}
	</style>
</head>
<body>
	<div id="imgBox"></div>
<script>
	window.onload = function () {
		var canvas = document.createElement('canvas');
		var w = window.innerWidth,
			h = window.innerHeight;
		canvas.width = w ;
		canvas.height = h ;

		var stage = new createjs.Stage( canvas );

		var img = new Image();
		img.src = './images/pageEnd1.png';

		img.onload = function() {

			var bg = new createjs.Bitmap( img );
			var bg2 = new createjs.Bitmap( img );

			bg.setTransform( 0, 0, 0.25, 0.25 );
			bg2.setTransform( canvas.width / 2, 0, 0.25, 0.25 );
			


			stage.addChild( bg );
			stage.addChild( bg2 );

			var headPortrait = new Image();

			headPortrait.crossOrigin = "Anonymous";
			headPortrait.src = 'http://wx.qlogo.cn/mmopen/gwhELYibibFdSaCiaolQolV5r004ZPlNRmJVFwZTzqWl0pDticDZmoxjyEgHpBDuRiagBRU1Pkuib6bzLPwJLPxD7FwA/0';
			headPortrait.onload = function() {
				var bitmapHeadPortrait = new createjs.Bitmap( headPortrait );
				bitmapHeadPortrait.x = canvas.width / 2 - 50;
				bitmapHeadPortrait.y = 50;		
				bitmapHeadPortrait.scaleX = 0.2;		
				bitmapHeadPortrait.scaleY = 0.2;		

				// 遮罩图形
				var shape = new createjs.Shape();
				shape.graphics.beginFill('#000').drawCircle(canvas.width / 2 - 30, 100,35);
				shape.x = 20;
				shape.y = 20;
				bitmapHeadPortrait.mask = shape;

				stage.addChild( shape );
				stage.addChild( bitmapHeadPortrait );
				stage.update();		


				// canvas 转base64
				var hc_image = new Image();
		        hc_image.src = canvas.toDataURL("image/png");
		        $('#imgBox').html( hc_image );
			}

		} 
	}
</script>
</body>
</html>